---
title: 数据索引
icon: material/dice-multiple-outline
comments: true
---

???+ info "信息"

    - 默认省略导入

        - `import numpy as np`
        - `import pandas as pd`

    - 缩写

        - DataFrame缩写为"DF"
        - Series缩写为"SE"

    - 默认使用数据集: [learn_pandas](https://share.ricolxwz.io/learn_pandas.csv)

## 索引器

### DF的列索引 {#DF的列索引}

???+ info "信息"

    已经导入:

    `df = pd.read_csv('data/learn_pandas.csv', usecols=['School', 'Grade', 'Name', 'Gender', 'Weight', 'Transfer'])`

#### 单个索引

通过`[列名]`或者`.列名`可以取出单个索引对应的列, 返回值为SE. 

???+ example "例子"

    ```
    [1]: df['Name'].head()
    0      Gaopeng Yang
    1    Changqiang You
    2           Mei Sun
    3      Xiaojuan Sun
    4       Gaojuan You
    Name: Name, dtype: object
    [2]: df.Name.head()
    0      Gaopeng Yang
    1    Changqiang You
    2           Mei Sun
    3      Xiaojuan Sun
    4       Gaojuan You
    Name: Name, dtype: object
    ```

##### 多个索引

通过`[列名组成的列表]`可以取出多个索引对应的列, 返回值为DF.

???+ example "例子"

    ```
    [1]: df[['Gender', 'Name']].head()
    x	Gender	Name
    0	Female	Gaopeng Yang
    1	Male	Changqiang You
    2	Male	Mei Sun
    3	Female	Xiaojuan Sun
    4	Male	Gaojuan You
    ```

### SE的行索引

???+ info "信息"

    已经生成:

    `s = pd.Series([1, 2, 3, 4, 5, 6], index=['a', 'b', 'a', 'a', 'a', 'c'])`

#### 以字符串为索引的SE

##### 单个索引

通过`[item]`可以取出单个索引对应的元素.

- 如果SE中只有单个值和该索引对应, 则返回这个标量值
- 如果SE中有多个值和该索引对应, 则返回一个SE

???+ example "例子"

    ```
    [1]: s['a']
    a    1
    a    3
    a    4
    a    5
    dtype: int64
    [2]: s['b']
    2
    ```

##### 多个索引 

通过`[item的列表]`可以取出多个索引对应的元素.

???+ example "例子"

    ```
    [1]: s[['c', 'b']]
    c    6
    b    2
    dtype: int64
    ```

###### 取出两个索引之间的元素

可以使用切片. 

???+ warning "注意"

    - 这里的切片与NumPy的[切片](/NumPy/数组索引/#切片索引)有一点不同, 会包含两个端点
    - 这两个索引在整个索引中必须唯一

        ???+ tip "Tip"

            如果这两个索引的值在整个索引中存在重复, 那么需要经过排序才能使用切片.

            ???+ example "例子"

                ```
                [1]: try:
                        s['a': 'b']
                     except Exception as e:
                        Err_Msg = e
                [2]: Err_Msg
                KeyError("Cannot get left slice bound for non-unique label: 'a'")
                [3]: s.sort_index()['a':'b']
                a    1
                a    3
                a    4
                a    5
                b    2
                dtype: int64
                ```

???+ example "例子"

    ```
    [1]: s['c': 'b': -2]
    c    6
    a    4
    b    2
    dtype: int64
    ```

#### 以整数为索引的SE

在使用读入函数的时候, 如果不特别使用`index_col`参数指定对应的列作为索引, 那么会生成从0开始的整数索引作为默认索引. 当然, 任意一组符合长度要求的整数都可以作为索引.

和字符串一样, 如果使用`[int]`或`[int_list]`, 可以取出对应索引{==元素==}的值.

???+ example "例子"

    ```
    [1]: s[1]
    1    a
    1    c
    dtype: object
    [2]: s[[2, 3]]
    2    d
    3    b
    dtype: object
    ```

???+ warning "注意"

    - 这里的切片与NumPy的[切片](/NumPy/数组索引/#切片索引)相同
    - 这里的切片中整数的含义是索引的{==位置==}, 而不是索引本身

        ???+ example "例子"

            如索引`1, 3, 1, 2, 5, 4`, 各个索引的位置分别为`0, 1, 2, 3, 4, 5`.

            ```
            [1]: s[1:-1:2]
            3    b
            2    d
            dtype: object
            ```

### DF的行/列索引

对于DF而言, 不仅能根据[列进行索引](#DF的列索引), 还能根据行进行索引. `loc`索引器和`iloc`索引器是一种对于DF索引来说更加普适的方法, 它既能行索引, 又能列索引.

- `loc`索引器: 基于{==元素==}的索引器
- `iloc`索引器: 基于{==位置==}的索引器

`loc`索引器的一般形式是`loc[*, *]`, 其中第一个`*`代表行的选择, 第二个`*`代表列的选择. 如果省略第二个位置写作`loc[*]`, 这个`*`指行的筛选. 

其中`*`的位置一共有五类合法对象, 分别是:

- 单个元素
- 元素列表
- 元素切片
- 布尔列表
- 函数

下面将依次说明.

???+ info "信息"

    - 已经导入:

        `df = pd.read_csv('data/learn_pandas.csv', usecols=['School', 'Grade', 'Name', 'Gender', 'Weight', 'Transfer'])`

    - 为了演示相应操作, 先利用`set_index`函数将`Name`列设为索引

        `df_demo = df.set_index('Name')`